<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="Pragma" content="no-cache">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<title>UPC VISION</title>
<!-- plugins:css -->
<link rel="stylesheet"
	href="vendors/iconfonts/mdi/css/materialdesignicons.min.css">
<link rel="stylesheet"
	href="vendors/iconfonts/puse-icons-feather/feather.css">
<link rel="stylesheet"
	href="vendors/iconfonts/simple-line-icon/css/simple-line-icons.css">

<link rel="stylesheet" href="css/jquery.datetimepicker.css">
<link rel="stylesheet" href="css/c3.css">
<link rel="stylesheet" href="css/jquery.contextMenu.css">
<!-- 
<link rel="stylesheet" href="vendors/css/vendor.bundle.base.css">
<link rel="stylesheet" href="vendors/css/vendor.bundle.addons.css">
 -->
<link rel="stylesheet" href="css/style.css">
<link rel="shortcut icon" href="images/favicon.png" />

<!-- plugin css for this page -->
<link rel="stylesheet"
	href="vendors/iconfonts/font-awesome/css/font-awesome.min.css" />
<!-- plugin css for this page -->
<!-- End plugin css for this page -->

<!-- End plugin css for this page -->
<!-- inject:css -->
<link rel="stylesheet" href="css/style.css">
<!-- endinject -->
<script src="js/jquery-3.4.1.js"></script>
<script src="js/jquery.contextMenu.js"></script>
<script src="js/bootstrap-datetimepicker.min.js"></script>
<script src="js/sockjs.min.js"></script>
<script src="js/stomp.min.js"></script>
<script src="js/c3.js"></script>
<script src="js/d3.js"></script>
<!-- 这是个集成好的综合包，但是版本有点低，有些功能还没有实现，所以需要把匹配的新版本的包整理出来。
<script src="vendors/js/vendor.bundle.base.js"></script>
<script src="vendors/js/vendor.bundle.addons.js"></script>
 -->
<!-- 这部分是SVG操作的第三方库，基于Angular 
<script src="js/hammer.min.js"></script>
<script src="js/uniwheel.js"></script>
<script src="js/control-icons.js"></script>
<script src="js/utilities.js"></script>
<script src="js/svg-utilities.js"></script>
<script src="js/shadow-viewport.js"></script>
<script src="js/svg-pan-zoom.js"></script>
 -->

<script src="js/app.js"></script>
<script src="js/router.js"></script>
<script src="js/navagator.js"></script>
<script src="js/lodash.js"></script>
<script type="text/javascript" src="js/iscroll.js"></script>
<script type="text/javascript" src="js/navbarscroll.js"></script>

<style>

.overlay {
  fill: none;
  pointer-events: all;
}
button {
  padding: 10px 20px;
}
	*{ padding: 0;margin: 0; }
	a {text-decoration: none;}
	ul,ol {list-style:none;}
	.box {height:50px;position:relative;width:25%;margin:0 auto;}
	.wrap{min-width: 320px;max-width:768px;margin:0 auto;overflow:hidden;position:relative;}
	.wrapper {position:relative;height:49px;line-height:50px;width:100%;overflow: hidden;margin:0 auto;border:1px solid #ccc;border-radius:25px;}
	.wrapper .scroller {position:absolute;padding:0 48% 0 50%;}
	.wrapper .scroller li {float: left;width:50px;height:13px;line-height:13px;text-align: center;font-style: none;margin: 0 20px; padding:30px 0 10px;position:relative;}
/*	.wrapper .scroller li:first-child {width:230px;}
	.wrapper .scroller li:last-child {width:210px;}*/
	.wrapper .scroller li span{display:block;border-left:1px solid #ccc;/*border-right:1px solid #ccc;*/width:100%;height:100%;}
	.wrapper .scroller li span i {display:inline-block;font-size:12px; font-style:normal;position:absolute;top:7px;left:-10px;}
	.pillar {display:inline-block;width:6px;height:100%;border-radius:10px;background:red;position:absolute;z-index:2;left:50%;margin-left:-3px;}
	h3{text-align: center;line-height: 60px}

</style>
<body>

<div id="svgt">
</div>

<button id="zoom_in">+</button>
<button id="zoom_out">-</button>

<h3 id="numberID">540</h3>
<div class="box">
	<span class="pillar"></span>
	<div class="wrapper" id="wrapper1">
	<div class="scroller">
		<ul class="clearfix">
			<li><span><i>不限</i></span></li>
			<li><span><i>1</i></span></li>
			<li><span><i>2</i></span></li>
			<li><span><i>3</i></span></li>
			<li><span><i>4</i></span></li>
			<li><span><i>5</i></span></li>
			<li><span><i>6</i></span></li>
			<li><span><i>700</i></span></li>
			<li><span><i>800</i></span></li>
			<li><span><i>900</i></span></li>
			<li><span><i>1000</i></span></li>
		</ul>
	</div>
	</div>
</div>

<script>
var number1 = 0;
function shownumber1(){
	console.log("number = "+number1);
    svg.attr("transform",
	        "translate(" + [0,0] + ")" +
	        "scale(" + 1+number1/100 + ")"
	    );

}
function tt(ds){
	console.log("diff");
	$('#wrapper1').navbarscroll({
		defaultSelect:ds,
		duibiScreenWidth:0.1, //单位以rem为准，默认为0.4rem
        scrollerWidth:1, //单位以px为准，默认为3,[仅用于特殊情况：外层宽度因为小数点造成的不精准情况]
        fingerClick:3, //目标第0或1个选项触发,必须每一项长度一致，方可用此项
		endClickScroll:function(obj){
			console.log(JSON.stringify(obj.text()));
		}
	});
}
$(function(){
	tt(3);
	//demo示例一到四 通过lass调取，一句可以搞定，用于页面中可能有多个导航的情况
	// $('.wrapper').navbarscroll();
	//demo示例五 通过id调取
	// $('.wrapper').navbarscroll({
	// 	defaultSelect:6,
	// 	endClickScroll:function(obj){
	// 		console.log(obj.text())
	// 	}
	// });
	//demo示例六 通过id调取

});



$("#svgt").load("ltgrh101.svg", null, changeAAction);

//页面加载完成后调用。在之前调用会导致不能正确获得对象。
function changeAAction() {
	var width = 960,
    height = 500;
		   
	// 获取图形宽高
	svg1 = document.getElementsByTagName("svg");
	svg1 = svg1[0];
  	width = svg1.attributes.width.value;
  	height = svg1.attributes.height.value;
  	console.log("widthaaa="+width+" heightbbb="+height+"");
  	// D3操作对象
	zoom = d3.behavior.zoom().scaleExtent([0.5, 8]).on("zoom", zoomed); 
	drag = d3.behavior.drag().origin(function() {
        var t = d3.select(this);
        return {
            x: t.attr("cx"),
            y: t.attr("cy")
        };
    }).on("drag",draged);
	drag.on("dragstart", function() {
		  d3.event.sourceEvent.stopPropagation(); // silence other listeners
		});
	svg = d3.select("svg").call(drag);//.call(zoom);
	 
	function draged(d){
			console.log("draged."+JSON.stringify(d3.event));
			
	        d3.select(this)
            .attr("cx",  d3.event.x)
            .attr("cy", d3.event.y);
			console.log("draged 1 . "+this);
			var trans = [d3.event.x,d3.event.y];
		    svg.attr("transform",
			        "translate(" + trans + ")" +
			        "scale(" + 1 + ")"
			    );

	}
	
	function zoomed() {
		console.log("zoomed -> translate= "+zoom.translate()+" scale= "+zoom.scale());
		translate = zoom.translate();

	    svg.attr("transform",
	        "translate(" + zoom.translate() + ")" +
	        "scale(" + zoom.scale() + ")"
	    );
	}
	 
	function interpolateZoom (translate, scale) {

	    zoomed();
	}
	 
	function zoomClick() {
	      tt(5);
	    var clicked = d3.event.target,
	        direction = 1,
	        factor = 0.2,
	        target_zoom = 1,
	        center = [width / 2, height / 2],
	        extent = zoom.scaleExtent(),
	        translate = zoom.translate(),
	        translate0 = [],
	        l = [],
	        view = {x: translate[0], y: translate[1], k: zoom.scale()};
	 
	    d3.event.preventDefault();
	    direction = (this.id === 'zoom_in') ? 1 : -1;
	    target_zoom = zoom.scale() * (1 + factor * direction);
	 
	    if (target_zoom < extent[0] || target_zoom > extent[1]) { return false; }
	 
	    translate0 = [(center[0] - view.x) / view.k, (center[1] - view.y) / view.k];
	    view.k = target_zoom;
	    l = [translate0[0] * view.k + view.x, translate0[1] * view.k + view.y];
	 
	    view.x += center[0] - l[0];
	    view.y += center[1] - l[1];
	 
	    interpolateZoom([view.x, view.y], view.k);
	}
	 
	d3.selectAll('button').on('click', zoomClick);
	 
}
var svg;

</script>
</body>